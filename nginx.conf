log_format json escape=json '{'
    '"time":"$time_iso8601",'
    '"remote_addr":"$remote_addr",'
    '"request":"$request",'
    '"status":$status,'
    '"body_bytes_sent":$body_bytes_sent,'
    '"http_referer":"$http_referer",'
    '"http_user_agent":"$http_user_agent",'
    '"request_time":$request_time'
'}';

server {
    listen 8080;
    server_name www.obmen-knig.ru;
    return 301 https://obmen-knig.ru$request_uri;
}

server {
    listen 8080;
    server_name obmen-knig.ru "";
    root /usr/share/nginx/html;
    index index.html;

    access_log /dev/stdout json;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff2?)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
